{"changed":true,"filter":false,"title":"buildspec.yml","tooltip":"/tripmgmt/buildspec.yml","value":"version: 0.2\n\nphases:\n  install:\n    runtime-versions:\n      java: corretto11 \n  pre_build:\n    commands:\n      - echo Logging in to Amazon ECR...\n      - aws --version\n      - aws ecr get-login-password --region $AWS_DEFAULT_REGION | docker login --username AWS --password-stdin <<AWS_ACCOUNT_ID>>.dkr.ecr.$AWS_DEFAULT_REGION.amazonaws.com\n      - REPOSITORY_URI=<<YOUR_REPOSITORY_URI>>\n      - COMMIT_HASH=$(echo $CODEBUILD_RESOLVED_SOURCE_VERSION | cut -c 1-7)\n      - IMAGE_TAG=build-$(echo $CODEBUILD_BUILD_ID | awk -F\":\" '{print $2}')\n  build:\n    commands:\n      - echo Build started on `date`\n      - echo Building the Docker image...\n      - ./gradlew clean\n      - ./gradlew bootWar -Pprod -Pwar\n      - docker build -t $REPOSITORY_URI:latest .\n      - docker tag $REPOSITORY_URI:latest $REPOSITORY_URI:$IMAGE_TAG\n  post_build:\n    commands:\n      - echo Build completed on `date`\n      - echo Pushing the Docker images...\n      - docker push $REPOSITORY_URI:latest\n      - docker push $REPOSITORY_URI:$IMAGE_TAG\n","undoManager":{"mark":-2,"position":0,"stack":[[{"start":{"row":0,"column":0},"end":{"row":28,"column":0},"action":"insert","lines":["version: 0.2","","phases:","  install:","    runtime-versions:","      java: corretto11 ","  pre_build:","    commands:","      - echo Logging in to Amazon ECR...","      - aws --version","      - aws ecr get-login-password --region $AWS_DEFAULT_REGION | docker login --username AWS --password-stdin <<AWS_ACCOUNT_ID>>.dkr.ecr.$AWS_DEFAULT_REGION.amazonaws.com","      - REPOSITORY_URI=<<YOUR_REPOSITORY_URI>>","      - COMMIT_HASH=$(echo $CODEBUILD_RESOLVED_SOURCE_VERSION | cut -c 1-7)","      - IMAGE_TAG=build-$(echo $CODEBUILD_BUILD_ID | awk -F\":\" '{print $2}')","  build:","    commands:","      - echo Build started on `date`","      - echo Building the Docker image...","      - ./gradlew clean","      - ./gradlew bootWar -Pprod -Pwar","      - docker build -t $REPOSITORY_URI:latest .","      - docker tag $REPOSITORY_URI:latest $REPOSITORY_URI:$IMAGE_TAG","  post_build:","    commands:","      - echo Build completed on `date`","      - echo Pushing the Docker images...","      - docker push $REPOSITORY_URI:latest","      - docker push $REPOSITORY_URI:$IMAGE_TAG",""],"id":1}],[{"start":{"row":11,"column":23},"end":{"row":11,"column":46},"action":"remove","lines":["<<YOUR_REPOSITORY_URI>>"],"id":3},{"start":{"row":11,"column":23},"end":{"row":11,"column":87},"action":"insert","lines":["992382402037.dkr.ecr.us-east-2.amazonaws.com/devops/tripmgmtdemo"]}],[{"start":{"row":10,"column":111},"end":{"row":10,"column":129},"action":"remove","lines":["<<AWS_ACCOUNT_ID>>"],"id":2},{"start":{"row":10,"column":111},"end":{"row":10,"column":123},"action":"insert","lines":["992382402037"]}]]},"ace":{"folds":[],"scrolltop":0,"scrollleft":0,"selection":{"start":{"row":10,"column":111},"end":{"row":10,"column":129},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":0},"timestamp":1739800774017}